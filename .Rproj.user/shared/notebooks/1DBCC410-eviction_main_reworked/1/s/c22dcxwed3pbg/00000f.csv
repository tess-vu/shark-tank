"0","# Clean and prepare tax data with delinquency separation."
"0","df_tax <- df_tax_raw %>%"
"0","  mutate("
"0","    census_tract = as.character(census_tract)"
"0","  ) %>%"
"0","  filter(!str_detect(census_tract, ""Other/Unidentified"")) %>%"
"0","  mutate("
"0","    # True delinquency indicators, based on penalty being on previous year's taxes."
"0","    has_penalty = penalty > 0,"
"0","    delinquent_prop_count = ifelse(has_penalty, num_props, 0),"
"0","    delinquent_balance = ifelse(has_penalty, balance, 0),"
"0","    avg_delinquent_balance = ifelse(has_penalty, balance / num_props, 0),"
"0","    "
"0","    # Overdue-only indicators, based on it being the current year."
"0","    overdue_only_props = ifelse(!has_penalty, num_props, 0),"
"0","    overdue_only_balance = ifelse(!has_penalty, balance, 0),"
"0","    "
"0","    # Transformations for modeling."
"0","    log_delinquent_balance = log1p(delinquent_balance),"
"0","    log_overdue_balance = log1p(overdue_only_balance)"
"0","  ) %>%"
"0","  rename(GEOID = census_tract)"
"0",""
"0","# Display tax data summary."
"0","cat(""TAX DELINQUENCY DATA SUMMARY\n"")"
"1","TAX DELINQUENCY DATA SUMMARY
"
"0","cat(sprintf(""Tracts with Tax Data: %d\n"", nrow(df_tax)))"
"1","Tracts with Tax Data: 401
"
"0","cat(sprintf(""Total Properties with Any Tax Balance: %s\n"", comma(sum(df_tax$num_props))))"
"1","Total Properties with Any Tax Balance: 84,943
"
"0","cat(sprintf(""Delinquent Properties (Penalty > 0): %s (%.1f%%)\n"", "
"0","            comma(sum(df_tax$delinquent_prop_count)),"
"0","            sum(df_tax$delinquent_prop_count) / sum(df_tax$num_props) * 100))"
"1","Delinquent Properties (Penalty > 0): 84,935 (100.0%)
"
"0","cat(sprintf(""Overdue Properties (No Penalty): %s (%.1f%%)\n"","
"0","            comma(sum(df_tax$overdue_only_props)),"
"0","            sum(df_tax$overdue_only_props) / sum(df_tax$num_props) * 100))"
"1","Overdue Properties (No Penalty): 8 (0.0%)
"
"0","cat(sprintf(""Total Delinquent Balance: $%s\n"", comma(sum(df_tax$delinquent_balance))))"
"1","Total Delinquent Balance: $508,908,377
"
"0","cat(sprintf(""Total Overdue-Only Balance: $%s\n"", comma(sum(df_tax$overdue_only_balance))))"
"1","Total Overdue-Only Balance: $55,963
"
