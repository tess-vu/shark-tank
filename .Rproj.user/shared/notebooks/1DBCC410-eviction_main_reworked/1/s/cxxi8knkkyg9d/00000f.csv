"0","#| fig-dpi: 300"
"0","#| fig-height: 7"
"0","#| fig-width: 12"
"0",""
"0","# Calculate prediction errors by racial majority to assess disparate impact."
"0","equity_metrics <- df_test_pred %>%"
"0","  filter(!is.na(racial_majority), racial_majority != """") %>%"
"0","  group_by(racial_majority) %>%"
"0","  summarize("
"0","    n_obs = n(),"
"0","    mean_observed = mean(filings_count, na.rm = TRUE),"
"0","    mean_predicted = mean(predicted, na.rm = TRUE),"
"0","    mae = mean(abs_error, na.rm = TRUE),"
"0","    mean_error = mean(residual, na.rm = TRUE),"
"0","    under_prediction_rate = sum(residual > 0) / n() * 100,"
"0","    .groups = ""drop"""
"0","  )"
"0",""
"0","# Display equity metrics table."
"0","equity_metrics %>%"
"0","  kable(digits = 2, caption = ""Model Performance Metrics by Tract Racial Majority"") %>%"
"0","  kable_styling(bootstrap_options = c(""striped"", ""hover""))"
