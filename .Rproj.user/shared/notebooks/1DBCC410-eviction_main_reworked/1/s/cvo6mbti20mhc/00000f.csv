"0","# Create year-month key for joining claims data to tract-level data."
"0","df_model_prep <- df_model_prep %>%"
"0","  mutate(year_month = floor_date(date, ""month""))"
"0",""
"0","df_claims_join <- df_claims %>%"
"0","  mutate(year_month = floor_date(date, ""month"")) %>%"
"0","  select(year_month, median_claim, claim_ratio)"
"0",""
"0","# Merge claims data to tract-level panel."
"0","df_model_prep <- df_model_prep %>%"
"0","  left_join(df_claims_join, by = ""year_month"")"
"0",""
"0","# Check merge success."
"0","claims_merge_stats <- df_model_prep %>%"
"0","  summarize("
"0","    total_obs = n(),"
"0","    has_claims = sum(!is.na(median_claim)),"
"0","    pct_with_claims = has_claims / total_obs * 100"
"0","  )"
"0",""
"0","cat(""CLAIMS DATA MERGE STATISTICS\n"")"
"1","CLAIMS DATA MERGE STATISTICS
"
"0","cat(sprintf(""Observations with claims data: %s (%.1f%%)\n"", "
"0","            comma(claims_merge_stats$has_claims), "
"0","            claims_merge_stats$pct_with_claims))"
"1","Observations with claims data: 27,336 (94.4%)
"
